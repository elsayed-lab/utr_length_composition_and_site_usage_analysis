```{r utr_composition}
# create lists to store results
utr_sequences      = list()
utr_composition_df = list()

# 5utr or 3utr
outfile_suffix = sprintf('%dutr', ifelse(feature_name == 'sl', 5, 3))

for (stage in c(stages, 'combined')) {
    # UTR sequence
    utr_sequences[[stage]] = get_utr_sequences(genes, fasta, results[[stage]],
                                               default_utr_width,
                                               utr5=feature_name == 'sl')

    # UTR sequence composition
    utr_composition_df[[stage]] = get_utr_composition(utr_sequences[[stage]])

    # Combine dataframes and save result
    results[[stage]] = merge(results[[stage]], utr_composition_df[[stage]],
                             by='name')
    outfile = paste(outfile_prefix, stage, paste0(outfile_suffix, '.csv'), sep='_')
    write.csv(results[[stage]], file=file.path('..', 'output', outfile),
              quote=FALSE, row.names=FALSE)
}
```

```{r save_gff}
# Write result to GFF
message(outfile_suffix)
output_gff = paste(outfile_prefix, paste0(outfile_suffix, '.gff'), sep='_')

fp = file(file.path("..", "output", output_gff))
message(output_gff)
writeLines(gff_lines, fp)
message("Done writing!")
close(fp)
```
